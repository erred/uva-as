# AS Exam

2020-05-26 Sean Liao

## WiFi (in)secure by choice

The first generation of WiFi was released in 1997, with standardization not far behind. WiFi 1 (802.11b) and WiFi 2 (802.11a) were adopted in 1999 with speeds of 11Mbps on 2.4Ghz and 54Mbps on 5Ghz. 2003 saw the introduction of WiFi 3 (802.11g) bringing 54Mbps speeds to 2.4Ghz. The next jump in speed came in 2009 with up to 600Mbps on both frequencies with WiFi 4 (802.11n), as well as the introduction of MIMO (Mulit Input, Multi Output) streams. WiFi 5 (802.11ac) in 2014 brought further speed enhancements and more importantly better MU-MIMO (Multi User MIMO) and beamforming for high efficiency and higher densities. The most recent generation, WiFi 6 (802.11ax) in 2019 brings several more power/density improvements as well as an expansion into 6Ghz frequencies and support for the latest security standard, WPA3.

Security-wise, the standards started with WEP (Wired Equivalent Privacy) in 1999, which were unfortunately handicapped by United States export regulations. The next protocol was WPA (WiFi Protected Access), intended as a transitional protocol between WEP and whatever came next. It was, however, short lived as hardware limitations made it difficult to support on older devices and the new standard, WPA2 was soon available beginning 2004. For a long time, WPA2 was considered mostly secure, nevertheless, in 2018 the most recent result of standardization, WPA3, was published. To increase adoption of security protocols, since 2006, usage of the WiFi trademark has required certification which includes WPA2 for now.

In the current state of affairs, WEP is considered broken, and its use is prohibited in certain places by regulation. WPA is also rarely seen in the wild, as WPA2 support has been mandatory since 2006. WPA2 can be considered to be vulnerable to offline bruteforce attacks as well as a protocol level attack (KRACK). The bruteforce attacks are unfortunate as they rely on the weak link (humans) to generate entropy. The KRACK attack demonstrated a failure in modelling, as even though separate parts of the protocol have been modelled and formally proven secure, it was where they connected and the real world possibilities of retries that broke the system. WPA3 is vulnerable to some downgrade attacks (to WPA2, to weaker security groups), to side channel channel attacks (timing, cache), and a denial of service attack, together collectively known as Dragonblood.

As far as recommendations go, for WPA2 it would include updating to get patches mitigating the KRACK attack, using the CCMP variant which doesn't share a key with all clients, and choosing a decently long passphrase. Passphrases are usually more human friendly, but if they follow any pattern, they may be easy to guess in targetted attacks. It provides, at most, protection against casual drive by attacks.

For WPA3, it can be hard to protect against the downgrade to WPA2 at this moment in time due to the protocol being relatively new and lacking universal client / access point support. The downgrade against security groups can be mitigated by disabling them, as can the timinig side channel. The caching side channel depends on implementation and there are some patches for mitigating the denial of service. All in all, it is still better than WPA2.

As a fallback, if the network is suspected to be vulnerable, higher level protocols can be used to tunnel connections or all traffic to a secure location. Examples include TLS/HTTPS for websites or VPNs for all traffic.

One criticism of WPA3 was its secretive development process. This resulted in its flaws being discovered only after standardization. Given the time and expense needed to roll out support for new protocols in hardware and the ubiquity of WiFi in wireless communications, we are likely going to be stuck with the current and any future protocols for quite some time.This makes it even more presssing that they be properly evaluated and audited before standardization.

Regarding WPA3 design, the choice to include multiple optional security groups is puzzling, as the industry trend has been moving away from multiple choice security primitives and configurability for some time, as demonstrated by TLS1.3 and WireGuard. To make current implementations secure, the only choice would be to disable all the other insecure security groups (leaving only NIST elliptical curves) and accelerate adoption so transitional modes can be disabled. For future protocol design, the recommendations would be to use primitives with more proven track records and leave out all the optional stuff (vendor politics may make this difficult).
